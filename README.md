# dismount-this-vhd

Windows 上でマウントした VHD ファイルをダブルクリックでサクッとカンタンにアンマウントするスクリプトです。

VHD ファイルは仮想ハードディスク(Virtual Hard Disk)であり、 Hyper-V などの仮想マシンのハードディスクとして利用することが多いファイルですが、仮想マシンを使わずに Windows が直接マウントすることも可能です。
VHD ファイルのマウントはいたって簡単で、他の形式のファイルを開く時と同じように、マウントしたい VHD ファイルをダブルクリックするだけです。

しかしながら、マウントした VHD ファイルをアンマウントするのは一筋縄ではいきません。

マウントした VHD ファイルをアンマウントする為には、 `ディスクの管理` (diskmgmt.msc) を開いて `VHD の切断` を選択し、確認画面で `OK` を押す必要があり少々面倒です。

このスクリプトは、そんな面倒な VHD ファイルのアンマウントを簡易化します。

## Requirements

このスクリプトは Windows10 で利用することを想定しています。

Windows7 や 8, 8.1 等でも動作した場合は、報告して頂けると嬉しいです。

## Installation

1.  サクッとアンマウントできるようにしたい VHD ファイルをマウントします。
2.  VHD ファイルをマウントして接続されたドライブに、 `dismount-this-vhd.cmd`, `dismount-this-vhd.ps1` の2つのファイルをコピーします。

    コピー先は、 VHD ファイルのドライブ内であればどこでも構いません。たいていの場合はドライブ直下に置くのが最もシンプルで使いやすいのではないかと思います。

## How to use it

1.  アンマウントしたい VHD ファイルのドライブにコピーした `dismount-this-vhd.cmd` をダブルクリックします。
2.  UAC により管理者権限で実行してよいか聞かれるので、 `はい` をクリックします。
3.  ドライブがアンマウントされます。

宗教上の理由により、コマンドプロンプトを利用することが許されない場合は、 `dismount-this-vhd.ps1` を `PowerShell で実行` することで同様の結果を得ることができます。
但し、この場合は右クリックメニューから選ぶ必要があるので、微妙に手間が増えます。
